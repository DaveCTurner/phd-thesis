\TODO{Intro}

\subsection{Complete Partial Orders and Continuous Functions}

The objects of study in domain theory are ordered structures with appropriate
completeness properties.
%
Two common such structures are CPOs and $\omega$-CPOs, as defined below.

\begin{definition} A \define{complete partial order (CPO)} is a
partial order $\langle D, \sqsubseteq_{D} \rangle$ that has
joins of all directed subsets of $D$.\end{definition}

\begin{definition} An \define{$\omega$-complete partial order ($\omega$CPO)} is
a partial order $\langle D, \sqsubseteq_{D} \rangle$ that has joins of all
increasing $\omega$-chains in $D$.\end{definition}

The completeness property is chosen to capture an appropriate notion of
approximation of elements of $D$ by some kind of limiting process of the
appropriate shape.
%
For example, consider the program $L \defeq \mathop{\mathbf{while}}
\mathbf{true} \mathop{\mathbf{do}} C \mathop{\mathbf{od}}$ whose meaning can be
approximated increasingly well by the sequence of programs $C$, $C;C$, $C;C;C$,
$\ldots$.
%
Therefore it could be possible to give each of these programs a denotation as an
element of an $\omega$CPO $D$ such that $\sem{C} \sqsubseteq_D \sem{C;C}
\sqsubseteq_D \sem{C;C;C} \sqsubseteq_D \ldots$ and use the limit of the
resulting $\omega$ chain as the denotation of $L$.
%
However, there is considerable freedom in choosing the appropriate notion of
approximation and it will be useful to avoid tying this discussion to any
particular choice, so it is worth making the following informal definition.

\begin{definition}[Informal] A \define{$\Phi$-complete partial order
($\Phi$CPO)} is a partial order $\langle D, \sqsubseteq_{D} \rangle$ that has
joins of subsets of $D$ that have the property $\Phi$.  \end{definition}

The property $\Phi$ serves to capture the notion of approximation under
discussion.
%
In general $\Phi$ must satisfy some extra conditions that make it a suitable
choice for approximating elements of $D$, although investigating these extra
conditions is beyond the scope of this discussion so it is sufficient to think
of $\Phi$ as being either $\Phi_d$ (directedness) or $\Phi_\omega$ (the property
of being an $\omega$-chain) in the following.
%
It is important here to emphasise that the choice of a suitable notion of
approximation $\Phi$ is a key variable in the development of domain theory,
because it turns out that neither directed sets nor $\omega$-chains quite
capture the appropriate notion of approximation in the theory of nominal sets
(the setting for much of the rest of this dissertation) and it is necessary to
choose a subtly different notion instead.

The property $\Phi$ also gives rise to a notion of $\Phi$-continuous function:
$f : \langle D, \sqsubseteq_D \rangle \to \langle E, \sqsubseteq_E, \rangle$ is
$\Phi$-continuous if it is a function $f : D \to E$ that preserves
\begin{itemize} \item the ordering $\sqsubseteq$ (i.e. it is monotone) \item the
property of $\Phi$-ness, and \item joins of the $\Phi$ subsets of $D$.
\end{itemize}
%
The collection of $\Phi$CPOs and $\Phi$-continuous functions form a category
$\mathbf{\Phi CPO}$.
%
If $\Phi \in \{\Phi_d, \Phi_\omega\}$ then the category $\mathbf{\Phi CPO}$ is
cartesian closed.
%
The cartesian product is given by the product of the underlying sets ordered
pointwise, and the exponential is given by the space of $\Phi$-continuous
functions, again ordered pointwise.
%
This is important for giving denotational semantics to a language with
higher-order functions.

\subsection{Algebraic CPOs}

Certain elements of a $\Phi$CPO $D$ cannot be reached by the join of a
succession of increasingly close proper approximations.
%
Such an element is called \textit{isolated}.
%
Computationally, the isolated elements of $D$ correspond to those computations
that can be realised in finite time.

\begin{definition} An element $d$ of the $\Phi$CPO $\langle D, \sqsubseteq_D,
\bot_D \rangle$ is \define{$\Phi$-isolated} if whenever $d \sqsubseteq_D \bigvee
x$ for some $x \subseteq D$ satisfying $\Phi$ it follows that there exists $d'
\in x$ such that $d \sqsubseteq_D d'$.
%
The collection of all $\Phi$-isolated elements of $D$ is written $D^{\circ}$.
\end{definition}

Intuitively the computationally feasible elements of $D$ are only those elements
that can be approximated by its $\Phi$-isolated elements.
%
Those $\Phi$CPOs that consist only of such approximable elements are called
\textit{algebraic}:
%
\begin{definition} A $\Phi$CPO $D$ is \define{algebraic} if for every $d \in D$
there exists an $x \subseteq D^\circ$ which is both $\Phi$ and such that $d =
\bigvee x$. \end{definition}
%
Sometimes algebraicity also includes a constraint on the size of $D$ --- for
example it may insist that that $D^\circ$ is countable --- but this point is not
dwelt upon here\footnote{
%
In fact, much of this dissertation works within the theory of nominal sets, and
in this theory the notion of cardinality is subtle because of the failure of the
Axiom of Choice.
%
For example, lemma \ref{lemma:fm:totalorder} implies that any (internally)
countable nominal set is discrete and therefore not particularly interesting for
the purposes of this discussion.}.

Importantly, if $f : D \to E$ is $\Phi$-continuous and $D$ is algebraic then $f$
is entirely specified by its action on $D^\circ$:

\begin{lemma} Let $\langle D, \sqsubseteq_D, \bot_D \rangle$ be an algebraic
$\Phi$CPO and let $f, g : \langle D, \sqsubseteq_D, \bot_D \rangle
\rightrightarrows \langle E, \sqsubseteq_E, \bot_E \rangle$ be two arrows of
$\mathbf{\Phi CPO}$ such that for every $d \in D^\circ$ it is the case that
$f(d) = g(d)$. Then $f = g$.  \end{lemma}

\begin{proof} Let $d \in D$, then by the algebraicity of $D$ there exists $x
\subseteq D^\circ$ which is both $\Phi$ and such that $d = \bigvee x$. Therefore
\begin{equation} \begin{array}[t]{rcll} f(d) &=& f \bigl( \bigvee x \bigr) \\
%
&=& \bigvee \{ f(d') \mid d' \in x \} & \text{by continuity of $f$}\\
%
&=& \bigvee \{ g(d') \mid d' \in x \} & \text{since $f$ and $g$ agree on
$D^\circ \supseteq x$}\\
%
&=& g \bigl(\bigvee x \bigr) & \text{by continuity of $g$} \\
%
&=& g(d) \end{array} \end{equation} as required. \end{proof}

The collection of algebraic $\Phi$CPOs and $\Phi$-continuous functions forms a
category $\mathbf{\Phi Alg}$.
%
Many of the constructions of $\mathbf{\Phi CPO}$ restrict to $\mathbf{\Phi
Alg}$.
%
For example, the cartesian product of $\Phi$CPOs preserves algebraicity.
%
However if $D$ and $E$ are algebraic then it is not necessarily the case that
the function space $D \to E$ is algebraic, so $\mathbf{\Phi Alg}$ is not
cartesian closed in general.
%
Fortunately it is often the case that $\mathbf{\Phi Alg}$ contains a cartesian
closed subcategory that is a suitable setting for some denotational semantics.
%
If $\Phi \in \{\Phi_d, \Phi_\omega\}$ then a suitable subcategory is the
collection of Scott domains, which are those algebraic $\Phi$CPOs where every
\textit{bounded} directed subset or \textit{bounded} $\omega$-chain has a join.
%
Alternatively, it could be the collection of \textit{strongly finite} or SFP
objects\cite{plotkin:powerdomains}.

\subsection{Nondeterminism in Domain Theory}

In order to capture a denotational semantics for nondeterministic choice, it is
possible to extend the notion of a $\Phi$CPO with a binary operation, $\sqcup$,
representing the nondeterministic sum of a pair of computations.
%
There are a number of possible axiomatisations of the operation $\sqcup$,
depending on the style of nondeterminism that is under study.

\begin{definition} A \define{Plotkin-nondeterministic $\Phi$CPO}
($\text{N}_P\Phi\text{CPO}$) is a $\Phi$CPO $\langle D, \sqsubseteq_D \rangle$
together with an idempotent, commutative and associative binary operation
$\mathord{\sqcup}_D : D \times D \to D$.

A \define{Hoare-nondeterministic $\Phi$CPO} ($\text{N}_H\Phi\text{CPO}$) is a
Plotkin-nondeterministic $\Phi$CPO $\langle D, \sqsubseteq_D, \mathord{\sqcup}_D
\rangle$ such that additionally $d \sqsubseteq_D d \sqcup_D d'$ for all $d, d'
\in D$.

A \define{Smyth-nondeterministic $\Phi$CPO} ($\text{N}_S\Phi\text{CPO}$) is a
Plotkin-nondeterministic $\Phi$CPO $\langle D, \sqsubseteq_D, \mathord{\sqcup}_D
\rangle$ such that additionally $d \sqcup_D d' \sqsubseteq_D d$ for all $d, d'
\in D$.  \end{definition}

Intuitively, the Hoare-style nondeterminism captures a `may do' semantics: a
nondeterministic choice between two computations contains at least as much
information as each of its parts, because it may produce the output of either of
its parts.
%
Conversely, the Smyth-style nondeterminism captures a `must do' semantics: fewer
guarantees can be made about the nondeterministic choice between two
computations, so the nondeterministic choice contains less information.
%
When the discussion is not about any particular style of nondeterminism, it is
enough to refer to $\text{N}_P\Phi\text{CPOs}$, $\text{N}_H\Phi\text{CPOs}$ and
$\text{N}_S\Phi\text{CPOs}$ simply as N$\Phi$CPOs.

The natural morphisms between N$\Phi$CPOs are $\Phi$-continuous functions that
are additionally $\sqcup$-homomorphisms, and these objects and morphisms form a
category $\mathbf{N\Phi CPO}$ with the obvious forgetful functor $U :
\mathbf{N\Phi CPO} \to \mathbf{\Phi CPO}$.
%
Furthermore this functor has a left adjoint $F$ associating to each $\Phi$CPO
$D$ the object $FD$ which is the free N$\Phi$CPO on $D$.
%
The composition $UF : \mathbf{\Phi CPO} \to \mathbf{\Phi CPO}$ is usually called
the \textit{powerdomain monad} and is often written simply $\mathcal{P}$.

A similar story unfolds when attention is restricted to algebraic $\Phi$CPOs.
%
Nondeterministic algebraic $\Phi$CPOs are defined similarly to more general
nondeterministic CPOs, and together with $\Phi$-continuous
$\sqcup$-homomorphisms they form a category $\mathbf{N\Phi Alg}$ with a
forgetful/free adjunction $F \dashv U : \mathbf{N\Phi Alg} \leftrightarrows
\mathbf{\Phi Alg}$ as before.
%
An advantage of restricting attention to algebraic $\Phi$CPOs is that the
powerdomain monad becomes a little easier to describe concretely in this
setting.
%
For example, if $D$ is an algebraic $\Phi$CPO then there is an associated
preorder ${!}D$ whose elements comprise the finite subsets of $D^\circ$ and
whose order is defined by $F \le_{{!}D} F'$ iff for all $d \in F$ there exists
$d' \in F'$ such that $d \sqsubseteq_D d'$.
%
The Hoare powerdomain $\mathcal{P}_{H} D$ is then given as the partial order
obtained by taking the quotient of ${!}D$ by the preorder equivalence.





\subsection{A Simple Domain Theory for Concurrency}

Dropping some of the generality developed above, in the following consider just
the notion of approximation given by directedness by letting $\Phi = \Phi_d$ and
just the Hoare `may do' style of nondeterminism.
%
Viewing nondeterminism as a computational effect (in the style of Moggi
\cite{moggi:monads}) draws attention to the Kleisli category of
$\mathcal{P}_{H}$ which, it turns out, is equivalent to the category
$\mathbf{PORel}$ of partial orders $\typeP, \typeQ, \ldots$ and monotone
relations between them.
%
In other words, an arrow $R : \typeP \to \typeQ$ is a relation $R \subseteq
\typeP \times \typeQ$ such that if $p' \le_{\typeP} p \mathrel{R} q \le_{\typeQ}
q'$ then $p' \mathrel{R} q'$.
%
Composition in $\mathbf{PORel}$ is straightforward relational composition, and
the identity relation on the partial order $\typeP$ is simply $\le_{\typeP}$.

Concretely the equivalence $\mathrm{Kl}(\mathcal{P}_{H}) \simeq \mathbf{PORel}$
factorises the monad $\mathcal{P}_{H}$ as \begin{equation} \xymatrix{
\mathbf{\Phi}_d \mathbf{Alg} \ar@/^2ex/@<-2pt>[rr]^{(-)^{\circ}} & \bot &
\mathcal{\mathbf{PORel}} \ar@/^2ex/@<-2pt>[ll]^{\mathrm{Idl}} } \end{equation}
where the functor $\mathrm{Idl}$ takes a partial order to its ideal completion
and $(-)^{\circ}$ takes an algebraic domain to the partial order of its isolated
elements.


\TODO{Write section introducing Domain Theory for Concurrency}

% vim: set filetype=tex foldlevel=0 cms=\%%s nowrap tw=80:
